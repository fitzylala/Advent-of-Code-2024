import java.util.ArrayList;

public class Day6 {

    public static String[] tryMove(String[] rows) {
        for (int i = 0; i < rows.length; i++) {
            for (int j = 0; j < rows[i].length(); j++) {
                if (rows[i].charAt(j) == '^') {
                    try {
                        if (rows[i - 1].charAt(j) == '#') {
                            rows[i] = rows[i].replace('^', '>');
                        } else {
                            rows[i] = rows[i].replace('^', 'X');
                            rows[i - 1] = rows[i - 1].substring(0, j) + "^" + rows[i - 1].substring(j + 1);
                        }
                    } catch (IndexOutOfBoundsException e) {
                        rows[i] = rows[i].replace('^', 'X');
                    }
                }

                if (rows[i].charAt(j) == '>') {
                    try {
                        if (rows[i].charAt(j + 1) == '#') {
                            rows[i] = rows[i].replace('>', 'v');
                        } else {
                            rows[i] = rows[i].replace('>', 'X');
                            rows[i] = rows[i].substring(0, j + 1) + ">" + rows[i].substring(j + 2);
                        }
                    } catch (IndexOutOfBoundsException e) {
                        rows[i] = rows[i].replace('>', 'X');
                    }
                }

                if (rows[i].charAt(j) == 'v') {
                    try {
                        if (rows[i + 1].charAt(j) == '#') {
                            rows[i] = rows[i].replace('v', '<');
                        } else {
                            rows[i] = rows[i].replace('v', 'X');
                            rows[i + 1] = rows[i + 1].substring(0, j) + "v" + rows[i + 1].substring(j + 1);
                        }
                    } catch (IndexOutOfBoundsException e) {
                        rows[i] = rows[i].replace('v', 'X');
                    }
                }

                if (rows[i].charAt(j) == '<') {
                    try {
                        if (rows[i].charAt(j - 1) == '#') {
                            rows[i] = rows[i].replace('<', '^');
                        } else {
                            rows[i] = rows[i].replace('<', 'X');
                            rows[i] = rows[i].substring(0, j - 1) + "<" + rows[i].substring(j);
                        }
                    } catch (IndexOutOfBoundsException e) {
                        rows[i] = rows[i].replace('<', 'X');
                    }
                }
            }
        }
        return rows;
    }

    public static boolean checkComplete(String[] rows) {
        boolean complete = true;
        for (int i=0; i<rows.length; i++) {
            for (int j=0; j<rows[i].length(); j++) {
                if (rows[i].charAt(j) == '^' || rows[i].charAt(j) == '>'
                        || rows[i].charAt(j) == 'v' || rows[i].charAt(j) == '<') {
                    complete = false;
                }
            }
        }
        return complete;
    }



    public static void main(String[] args){
        String input = "..........#.............................#...............#...........#....................#...........#............................\n" +
                "..............................#.......#...#.....#.....#...............#.#..#.......................#............#.................\n" +
                ".............#...........#.#........#............#..........................#.........#.......#......#............................\n" +
                "......................................................#....#..#.............#................................#...#............##..\n" +
                "...............#.....#....................................#......................................................#................\n" +
                "..................##............#......#...............................................................#...................#......\n" +
                ".#......#...........................................................#............................#................................\n" +
                "#..#.............#...............................#.....#....#.............................#....#..............................#...\n" +
                "#...##..........#.........................#.................................................#............#...............#........\n" +
                "............#...............#..............................................#.................................#..........##........\n" +
                "..............#...................#......##...#.....#....................#.......................................................#\n" +
                ".#.....#....#......................#...#........................................#.#.............#.........#.......................\n" +
                "#..#...............#........##.........#.....#..........#.....##.........................#.....#.#................................\n" +
                "...............#...............................#.....#.................................................#..##......................\n" +
                "......#...................#..........#...........................................#....#...........................................\n" +
                "...............................................#...#....##.................................................#.....#................\n" +
                ".................#.........#..............................#........#...#...#...................................#..................\n" +
                "...........#..#.....#...#.........................#..........#.#.............#....#...................##..........................\n" +
                ".........................................#.........................#.#............#...#...##............................#.........\n" +
                ".....#......................................#....................................................#..............#.................\n" +
                "..................................................#..................#................#.............#.#..#..................#.....\n" +
                "............................................#.....#......................#........#..........................................#....\n" +
                ".......#..........................#...#...................................#.........................#...#..........#......#.......\n" +
                "............#...........##........................................................................#......................#........\n" +
                "#.#...............................................#........#..........#.#..#...#................................#.................\n" +
                "..#.........................#.#........................#....##..................................................#............#....\n" +
                ".....................................................................................#...............#...........#..........#.....\n" +
                "....................#..........#................................#...............................................#.................\n" +
                "#..............#.#...........#.........#..........#..........................#......................##........#.........#.........\n" +
                "....#....#...............................................................................#...#...........#............#...#...#...\n" +
                ".......................................................##......................#...#................................#.............\n" +
                ".......#...........##...........................#..............#..............................#...................#......#........\n" +
                "......#.........#..............................................................#........#..#..........#.......#..#...#.....#....#.\n" +
                "....#.............................................#........#....#..................................#..............................\n" +
                "..........#......#...........#....................................#..............#.......#...#............#.......................\n" +
                "...........................................................................................#.......#..............................\n" +
                ".#..................................................#.............................#..................#...................#........\n" +
                "......#..#.#................#.....................#..................................#.............#...............#..............\n" +
                "...............................#..................#........#......................................................................\n" +
                "......................#..................................................................................#.........#..............\n" +
                "...............................................................................................................................#..\n" +
                ".......#..............#...........................................................#......................#.......................#\n" +
                "#...............................#..............................#.......#..............................#...#...#........#..........\n" +
                "............................#....#...#.........#....#................................................................#............\n" +
                ".....................#.................................................................#..#....#..................#...............\n" +
                "......................#.............#.............................#...................................................#...........\n" +
                "....#.................#.#.........##................#.....#....................................................#.............#....\n" +
                "...............................#...#...................#.......................................#......#...........................\n" +
                "....#.............................................................................................................................\n" +
                "...#.......................................................................................................#............#.......#.\n" +
                "..#.............##.............................................................#...#............................#............#....\n" +
                "......................#.......#............#........................................................#..................#......#...\n" +
                "...................#.............#..................#..............................#............#........#...................#....\n" +
                "....................#...........#.........................................................#......#.......#...........#.....##.....\n" +
                "...........#.........................................#.............................#..............#..................#............\n" +
                "......................#.........#...................#......#...........................................#..........................\n" +
                "..#....#...#.............................#..............#.....................#............#...................................#..\n" +
                ".....#.............................#....#..................................#...................#...#.............#................\n" +
                "...................#...#...........#........................#.............#........................#...#.............#..........#.\n" +
                "...#...........#......#.......#..............#......#..........#.....#............................................................\n" +
                "..#......................................................#......#...........................#...........#......#..#...............\n" +
                "........#............................#.#....................#...#...#......#.....#...............................................#\n" +
                ".............#....#........#.........................................................................................#.........#..\n" +
                "....................................................................................................#.............................\n" +
                "..#........................#....#............................................................................#....................\n" +
                ".......................................#.....#.#.......................................#......#........#.#...................#....\n" +
                ".................#........#....................................#...#..#................................#..........................\n" +
                "...........#.................................................................................................#....................\n" +
                "......................#..................#...#.............#................##................#.......#...........#.........#.....\n" +
                "............#..#................#.............................................#............##..................##..........#......\n" +
                "......#.#.......................#............#...........................................................#........................\n" +
                "#......................................#.#......^...............................................#.................................\n" +
                "........#...........................................................#...............#.............................................\n" +
                "...#.............................................#.................#...............#.............................#...#.#..........\n" +
                "....................#........#...........##.......................#.................#..................#................#.........\n" +
                "#.................................................................................................................................\n" +
                "............#.......................................................................................#.#.........#..............#..\n" +
                "...............#....#............#..................................................#......##.................................#...\n" +
                ".............................#.........#...............#......#.......#.................#........................#........#.......\n" +
                "......................................................#........................................................#.................#\n" +
                ".................#.#...............#......................................................................................#....#..\n" +
                "........#.............#......................#...........#...........#......................................#..............#......\n" +
                "......................#......................#...........#.....#.....##............................................#....#.........\n" +
                ".............#................................................................................#..........#.....#..................\n" +
                "............##...........................#.................................#..#.#....................................#............\n" +
                "..............................................................................................#............................#......\n" +
                "...#.............................#..#..#....................................#..............#....#.................................\n" +
                ".....#..........................................................#.....#......#.........#..........................................\n" +
                "....##......#.....................#..........#..............#..................#.#..............#........#...........#....#.......\n" +
                ".....#...#.........#............#............#.............................................................#......................\n" +
                ".........#...................................#...........#.....................................##.....#............#..............\n" +
                ".....##.#............##.....................#..........................#.................................#........#...............\n" +
                ".......................#..............##...#...................................................#.........#........................\n" +
                "..#........#.......#...#..##............#....................................................................#...........#.....#..\n" +
                "..#.....................................................................#..............#.............#...................#........\n" +
                "...........#..........#..........#.....#.................................................................#..#.....................\n" +
                "..........#................#........................................................##.#...............................#.#......#.\n" +
                "#............................................#...........................##...#.......................#.............#.............\n" +
                "..#............#........................................................................................................#.........\n" +
                "....................................................#....................#............#...............#..........................#\n" +
                "........................................................................#.......#.....................................#.#.........\n" +
                "................#..#......................#...........................................#...........................................\n" +
                "........................##............................................#.............##..........................#.......#....#....\n" +
                ".........#.......#..............................#......#....#............#..................#...#.................................\n" +
                "#.........#............................#....#.#..#.........................................................##.....................\n" +
                ".#..##...............#....#.............................#...............#........#.......................................#......#.\n" +
                "...#............................................................#.....................#.................#.....#...................\n" +
                "...#...........#..#.............................#.....#.............................................................#.............\n" +
                "...#.........................#..............................................................................................##....\n" +
                ".........................#...........................#.......................#...........#........................................\n" +
                ".#..................................#.............................................................................................\n" +
                "....................................................................#...........##.....#.#.........#.....#........................\n" +
                "................#...............................#........#........................................................................\n" +
                "......#....#.................................#...................................#.#.........#.....#....................#.........\n" +
                "................#..............................#.......................#...#.....#.......#................#.......................\n" +
                "....................#......................................#..#...........#.#.................#...#.......................#.......\n" +
                ".............#..#...#............................#.#...........................................#.......................#..........\n" +
                ".........#..........#.................#....................................#.#..........................................#.........\n" +
                "....#.............#......................................................#...........#...........................#................\n" +
                "........#.#............................#...........................................#.................#..............#..........#..\n" +
                "..............#..........................#............#.........#....#...#.....#.........................#....#...............##..\n" +
                "...................#.........................................................#.......#........#..............#..........#.........\n" +
                ".#........#....#..................................#..#.#...............#............#...........#.................................\n" +
                "...............................................................................................#.....#....#.............#.........\n" +
                "...........#..........#...........................................#.........#..............#................#..........#..........\n" +
                "............#.................................###..............#.#...............................................................#\n" +
                "......#...................................................................................#............#...#..........#.....#.....\n" +
                ".............#..................#...................#......#.........#..#.......................#....#................#..........#\n" +
                "..#....##................................#.................#...........................#.......#....#...#..........#..............\n" +
                "...............................#......................................#.........#.............#......................#..........#.";

        String[] originalRows = input.split("\\R+");

        String[] rows = originalRows.clone();
        while (!checkComplete(rows)) {
            rows = tryMove(rows);
        }

        int xcounter =0;
        for (String row : rows) {
            for (int i=0; i<row.length(); i++) {
                if (row.charAt(i) == 'X') {
                    xcounter++;
                }
            }
            System.out.println(row);
        }
        System.out.println("Total Xs: " + xcounter + "\n");
        // end of part 1

        int loopCounter = 0;
        for (int i=0; i < rows.length; i++) {
            for (int j=0; j< rows[i].length(); j++) {

                if (rows[i].charAt(j) != 'X') { continue; }

                String[] changedRows = originalRows.clone();
                changedRows[i] = changedRows[i].substring(0,j) + "#" + changedRows[i].substring(j+1);

                for (int n=0; n<(changedRows.length * changedRows[i].length() +1); n++){
                    if (checkComplete(changedRows)){
                        break;
                    } else {
                        changedRows = tryMove(changedRows);
                    }
                    if (n== changedRows.length * changedRows[i].length()) {
                        System.out.printf("Loop found at %d, %d%n", i, j);
                        loopCounter++;
                    }
                }
            }
        }
        System.out.println("Potential loops: " + loopCounter + "\n");
    }
}